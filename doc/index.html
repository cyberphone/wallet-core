<!DOCTYPE html>
<html lang='en'>
<head>
  <link rel='icon' href='webpkiorg.png' sizes='192x192'>
  <meta name='viewport' content='initial-scale=1.0'>
  <meta charset='UTF-8'>
  <title>Wallet Core</title>
  <link rel='stylesheet' type='text/css' href='style.css'>
</head>
<body>
<h3 style="text-align:center;font-weight:normal;font-size:1.5em">Saturn - Payment Authorization Wallet</h3>
<i>Disclaimer: this is a specification in an early state, subject to change without notice.</i>
<h3 id='introduction'>1.&nbsp; Introduction</h3>
This document describes the core components of the Saturn wallet.
Note that Saturn is a <i>payment authorization </i> system for end-users,
not a payment system.  Saturn is heavily influenced by the current
&quot;gold&nbsp;standard&quot; for consumer payments, <a href='https://www.emvco.com/'>EMV<img src='xtl.svg' alt='emv'></a>.
<p style='padding-bottom:0;margin-bottom:0'>
Compared to EMV, Saturn introduces several enhancements:
</p>
<ul style='padding-top:0;margin-top:0'>
  <li style='padding-top:0.5em'>For privacy reasons user authorizations are <i>encrypted</i>.</li>
  <li>Intended to work with <i>any</i> account based payment system.</li>
  <li>Eliminates specific on-line solutions like 3D Secure.</li>
  <li>Receipt option.</li>
  <li>Account balance option.</li>
  <li>Built-in support for authorization of non-direct payments.</li>
</ul>
<p>
Saturn builds on the idea that different payment networks should not
need unique user authorizations solutions; only identifiers
related to accounts and payment networks need to be adapted.
This data is provided in the associated virtual payment cards (payment credentials),
making the wallet software <i>universal</i>.
</p>
The sequence diagram below outlines the Saturn protocol: 
<div class='webpkifloat'><img src='sequence-diagram.png' class='webpkibox' style='width:50em' title='Sequence Diagram'></div>
<h3 id='operation'>2.&nbsp; Detailed Operation</h3>
To guide the reader, operation is described based on an example which
in turn provides links to the formal definitions.
<p>
The Saturn protocol is based on CBOR [<a href='https://www.rfc-editor.org/rfc/rfc8949.html'>RFC8949<img src='xtl.svg' alt='rfc8949'></a>] which is a <i>binary</i> interchange format.
However, for documentation purposes, messages are shown in <i>diagnostic notation</i>.
</p>
<h5 id='initation'>2.1.&nbsp; Initiation</h5>
The payment proccess is initiated when the Payer hits a &quot;Pay&quot;
button on the Web or scans a QR-code, causing the wallet to perfom a HTTP&nbsp;GET
(step #1 in the sequence diagram) to the Payee service.  This returns a <a href='#authorization-request'>Authorization Request</a>
(step #2 in the sequence diagram) like the following:
<div class='webpkifloat'><div class='webpkibox' id='authz-req.txt' style='width:50em'>{<br>&nbsp;&nbsp;1:&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;1:&nbsp;&quot;Space&nbsp;Shop&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;2:&nbsp;&quot;722385402&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;3:&nbsp;&quot;600.00&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;4:&nbsp;&quot;EUR&quot;<br>&nbsp;&nbsp;},<br>&nbsp;&nbsp;2:&nbsp;[&quot;https://cardnetwork.com&quot;,&nbsp;&quot;https://banknet2.org&quot;]<br>}</div></div>
<h5 id='wallet-request-ui'>2.2.&nbsp; Wallet Request UI</h5>
After receival of the <a href='#authorization-request'>Authorization Request</a>,
the wallet should display a UI like the following:
<div class='webpkifloat'><img src='wallet-ui.svg' style='padding:0;width:25em' class='webpkibox'  title='Wallet UI'></div>
If the wallet contains multiple 
<a href='#payment-credentials'>Payment&nbsp;Credentials</a>
matching the Payee
request, the Payer needs to select (step #3 in the sequence diagram) a suitable
credential, unless the default (or last used) is deamed suitable.
<h5 id='payer-authorizes-the-request'>2.3.&nbsp; Payer Authorizes the Request</h5>
Assuming that the Payer accepts and subsequently authorizes 
(step #4 in the sequence diagram) the request,
the wallet will perform a HTTP&nbsp;POST (step #5 in the sequence diagram)
to the Payee service containing an
<a href='#authorization-response'>Authorization Response</a>
object like the following: 
<div class='webpkifloat'><div class='webpkibox' id='authz-res.txt' style='width:50em'>1010([&quot;https://saturn.standard/v4&quot;,&nbsp;{<br>&nbsp;&nbsp;0:&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;1:&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1:&nbsp;&quot;Space&nbsp;Shop&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:&nbsp;&quot;722385402&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3:&nbsp;&quot;600.00&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4:&nbsp;&quot;EUR&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;},<br>&nbsp;&nbsp;&nbsp;&nbsp;2:&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1:&nbsp;&quot;https://banknet2.org&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:&nbsp;&quot;mybank.com&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;},<br>&nbsp;&nbsp;1:&nbsp;3,<br>&nbsp;&nbsp;2:&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;1:&nbsp;-29,<br>&nbsp;&nbsp;&nbsp;&nbsp;4:&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1:&nbsp;2,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1:&nbsp;1,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-2:&nbsp;h'e812b1a6dcbc708f9ec43cc2921fa0a14e9d5eadcc6dc63471dd4b680c6236b5',<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-3:&nbsp;h'9826dcbd4ce6e388f72edd9be413f2425a10f75b5fd83d95fa0cde53159a51d8'<br>&nbsp;&nbsp;&nbsp;&nbsp;},<br>&nbsp;&nbsp;&nbsp;&nbsp;7:&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1:&nbsp;2,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1:&nbsp;1,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-2:&nbsp;h'0af00948182f232dbb8dd0293fe9cab65a5f53e61d327e433d4b299f45f3b374',<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-3:&nbsp;h'0cf0c35eaacfc066087b66fc7d4dd66da6623632f702f7fa5e4eb5bdeab17a12'<br>&nbsp;&nbsp;&nbsp;&nbsp;},<br>&nbsp;&nbsp;&nbsp;&nbsp;10:&nbsp;h'45929ac1eff36cb4e46ddeee74a4b87126d0941c45d9a3fe2f84c4b16c2eff88e7ffd43b99e2d2ea'<br>&nbsp;&nbsp;},<br>&nbsp;&nbsp;8:&nbsp;h'128fbfab6357ade38b7037eedac4e15f',<br>&nbsp;&nbsp;9:&nbsp;h'b089230428cfa2fc1fc4e2ed',<br>&nbsp;&nbsp;10:&nbsp;h'45382d051af33e4966318f33f308836afcfae99ba775356a90bff46a015ed9fcfbd85c00c2affc035b88535598dcb62b61848ebbad3351a80267401ac39a28f970601095d194174bc626f575137cf141d3cbe4703102121909cd7861644a4cdd8490bd543a052885243c949c8692c2cf31b30c86f9433ee5a1bbb6e934f3d8e4e0153734d8cb23ad953e8339b026c4e4e0b32b1ab981b016a2e144e00b2e04857c1084c77b86b3346697a786ad533293361e1b6e1f93d041d3be1ed20c0b88f1373518105ef97afb6bca242f3cc93e4a1152cbaf2cabf6c72930e3bcc29678272c20ea24'<br>}])</div></div>
<h5 id='wallet-termination'>2.4.&nbsp; Wallet Termination</h5>
After successful (or failed) authorization, the 
<a href='#authorization-response'>Authorization Response</a>
should return a message (step #6 in the sequence diagram).
This message depends on how the payment process was initiated,
and is yet to be specified.
<h3 id='reference'>3.&nbsp; Reference</h3>
This section contains a reference to the Saturn messages.
<h5 id='authorization-request'>3.1.&nbsp; Authorization Request</h5><div class='webpkifloat'><table class='webpkitable' style='width:52em'><tr><th>Label</th><th>Name</th><th>Type</th><th style='width:100%'>Description</th></tr><tr><td style='text-align:center'><code>1</code></td><td><code>paymentRequest</code></td><td style='text-align:center'><code>map</code></td><td>Holds the <a href='#payment-request'>Payment&nbsp;Request</a> object.</td></tr><tr><td style='text-align:center'><code>2</code></td><td><code>paymentNetworks</code></td><td style='text-align:center'><code>array</code></td><td>Holds a non-empty list of payment network/method identifiers that the Payee (merchant) supports.  Identifiers are expressed as CBOR strings (tstr).</td></tr></table></div>
Authorization&nbsp;Request is the core Payee (merchant) to wallet message.
In same-device Web contexts this message is also associated
with opening the wallet application.
<h5 id='authorization-response'>3.2.&nbsp; Authorization Response</h5><div class='webpkifloat'><table class='webpkitable' style='width:52em'><tr><th>Label</th><th>Name</th><th>Type</th><th style='width:100%'>Description</th></tr><tr><td style='text-align:center'><code>0</code></td><td><code>customData</code></td><td style='text-align:center'><code>map</code></td><td>Holds <a href='https://cyberphone.github.io/javaapi/org/webpki/cbor/doc-files/encryption.html' title='CBOR Encryption Format (CEF)'>CEF<img src='xtl.svg' alt='CEF'></a> custom (<i>unencrypted</i>) data in the form of a copy of the <a href='#pass-through'>&quot;Pass&nbsp;Through&quot;&nbsp;Data</a> object.</td></tr></table></div>
<h5 id='pass-through'>3.3.&nbsp; &quot;Pass Through&quot; Data</h5><div class='webpkifloat'><table class='webpkitable' style='width:52em'><tr><th>Label</th><th>Name</th><th>Type</th><th style='width:100%'>Description</th></tr><tr><td style='text-align:center'><code>1</code></td><td><code>paymentRequest</code></td><td style='text-align:center'><code>map</code></td><td>By including a copy of the <a href='#payment-request'>Payment&nbsp;Request</a> in the user authorization, this object remains <i>authoritative</i> throughout the payment process (except for interbank operations).</td></tr><tr><td style='text-align:center'><code>2</code></td><td><code>serviceProvider</code></td><td style='text-align:center'><code>map</code></td><td>Holds the <a href='#service-provider'>Service&nbsp;Provider&nbsp;Information</a> required by the Payee (merchant) for deriving which payment network to use and initiating a compatible payment transaction request.</td></tr></table></div>
<h5 id='payment-request'>3.4.&nbsp; Payment Request</h5><div class='webpkifloat'><table class='webpkitable' style='width:52em'><tr><th>Label</th><th>Name</th><th>Type</th><th style='width:100%'>Description</th></tr><tr><td style='text-align:center'><code>1</code></td><td><code>commonName</code></td><td style='text-align:center'><code>tstr</code></td><td>Payee (merchant) common name to be shown in UIs.</td></tr><tr><td style='text-align:center'><code>2</code></td><td><code>instanceId</code></td><td style='text-align:center'><code>tstr</code></td><td>Payee (merchant) transaction Id.</td></tr><tr><td style='text-align:center'><code>3</code></td><td><code>amount</code></td><td style='text-align:center'><code>tstr</code></td><td>Monetary amount.</td></tr><tr><td style='text-align:center'><code>4</code></td><td><code>currency</code></td><td style='text-align:center'><code>tstr</code></td><td>Currency.</td></tr><tr><td style='text-align:center'><code>5</code></td><td><code>nonDirect</code></td><td style='text-align:center'><code>map</code></td><td><i>Optional</i>: Non-direct payment request.</td></tr></table></div>
<h5 id='service-provider'>3.5.&nbsp; Service Provider Information</h5><div class='webpkifloat'><table class='webpkitable' style='width:52em'><tr><th>Label</th><th>Name</th><th>Type</th><th style='width:100%'>Description</th></tr><tr><td style='text-align:center'><code>1</code></td><td><code>paymentNetwork</code></td><td style='text-align:center'><code>tstr</code></td><td>Copy of the same attribute in the selected virtual card (see <a href='#payment-credentials'>Payment&nbsp;Credentials</a>).</td></tr><tr><td style='text-align:center'><code>2</code></td><td><code>paymentService</code></td><td style='text-align:center'><code>tstr</code></td><td>Copy of the same attribute in the selected virtual card (see <a href='#payment-credentials'>Payment&nbsp;Credentials</a>).</td></tr></table></div>
<h5 id='signed-authorization'>3.6.&nbsp; Signed Authorization</h5><div class='webpkifloat'><table class='webpkitable' style='width:52em'><tr><th>Label</th><th>Name</th><th>Type</th><th style='width:100%'>Description</th></tr><tr><td style='text-align:center'><code>1</code></td><td><code>passThrough</code></td><td style='text-align:center'><code>map</code></td><td>Holds the <a href='#pass-through'>&quot;Pass&nbsp;Through&quot;&nbsp;Data</a> object.</td></tr><tr><td style='text-align:center'><code>2</code></td><td><code>payeeHost</code></td><td style='text-align:center'><code>tstr</code></td><td>Host name or IP address of invoking Payee (merchant).</td></tr><tr><td style='text-align:center'><code>3</code></td><td><code>accountId</code></td><td style='text-align:center'><code>tstr</code></td><td>Account identifier associated with the virtual card.</td></tr><tr><td style='text-align:center'><code>4</code></td><td><code>serialNumber</code></td><td style='text-align:center'><code>tstr</code></td><td>Serial number of the virtual card.</td></tr><tr><td style='text-align:center'><code>5</code></td><td><code>platformData</code></td><td style='text-align:center'><code>array</code></td><td>Array holding the name and version of the operating system in <code>[0]</code> and <code>[1]</code> respectively, expressed as CBOR strings.</td></tr><tr><td style='text-align:center'><code>6</code></td><td><code>walletData</code></td><td style='text-align:center'><code>array</code></td><td>Array holding the name and version of the wallet software in <code>[0]</code> and <code>[1]</code> respectively, expressed as CBOR strings.</td></tr><tr><td style='text-align:center'><code>7</code></td><td><code>location</code></td><td style='text-align:center'><code>array</code></td><td><i>Optional</i>: Array holding longitude <code>[0]</code> and latitude <code>[1]</code>, expressed as CBOR floats.</td></tr><tr><td style='text-align:center'><code>8</code></td><td><code>timeStamp</code></td><td style='text-align:center'><code>tstr</code></td><td>ISO date-time string using UTC (T) or local time (Z) format.</td></tr><tr><td style='text-align:center'><code>-1</code></td><td><code>signature</code></td><td style='text-align:center'><code>map</code></td><td>Authorization signature.</td></tr></table></div>
<h3 id='payment-credentials'>4.&nbsp; Payment Credentials</h3>
A fundamental part of the wallet is a local database holding
enrolled payment credentials.
<p style='margin-bottom:0.5em;padding-bottom:0'>
Each entry in the database contains a payment credential according
to the following definition:
</p>
<div class='webpkifloat'><table class='webpkitable' style='width:52em'><tr><th>Label</th><th>Name</th><th>Type</th><th style='width:100%'>Description</th></tr><tr><td style='text-align:center'><code>1</code></td><td><code>paymentNetwork</code></td><td style='text-align:center'><code>tstr</code></td><td>Payment network/method identifier.</td></tr><tr><td style='text-align:center'><code>2</code></td><td><code>paymentService</code></td><td style='text-align:center'><code>tstr</code></td><td>Payment service URL or host name.</td></tr></table></div>
<h3 id='authorization-processing'>5.&nbsp; Authorization Processing</h3>
This section describes how
<a href='#authorization-response'>Authorization&nbsp;Response</a> messages
should be processed, using the
<a href='#authz-res.txt'>sample&nbsp;object</a>  and
<a href="#test-vectors">Test Vectors</a>.
<h5>5.1.&nbsp; Decryption</h5>
Firstly the <a href='#authorization-response'>Authorization&nbsp;Response</a>
object needs to be <i>decrypted</i> using a private key associated with the 
supplied <code>publicKey</code> or <code>keyId</code> attribute.
In the sample, a <code>publicKey</code> attribute was used.
The decryption process should return two CBOR objects:
the <a href='#patj-through'>&quot;Path Through&quot;Information</a>
object which is supplied in clear:
<div class='webpkifloat'><div class='webpkibox' id='pass-through.txt' style='width:50em'>{<br>&nbsp;&nbsp;1:&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;1:&nbsp;&quot;Space&nbsp;Shop&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;2:&nbsp;&quot;722385402&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;3:&nbsp;&quot;600.00&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;4:&nbsp;&quot;EUR&quot;<br>&nbsp;&nbsp;},<br>&nbsp;&nbsp;2:&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;1:&nbsp;&quot;https://banknet2.org&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;2:&nbsp;&quot;mybank.com&quot;<br>&nbsp;&nbsp;}<br>}</div></div>
and another object which after decryption should read like the following:
<div class='webpkifloat'><div class='webpkibox' id='restored.txt' style='width:50em'>{<br>&nbsp;&nbsp;2:&nbsp;&quot;spaceshop.com&quot;,<br>&nbsp;&nbsp;3:&nbsp;&quot;FR7630002111110020050014382&quot;,<br>&nbsp;&nbsp;4:&nbsp;&quot;010049255&quot;,<br>&nbsp;&nbsp;5:&nbsp;[&quot;Android&quot;,&nbsp;&quot;14.1&quot;],<br>&nbsp;&nbsp;6:&nbsp;[&quot;Saturn&quot;,&nbsp;&quot;1.0.0&quot;],<br>&nbsp;&nbsp;8:&nbsp;&quot;2024-09-01T13:28:02-02:00&quot;,<br>&nbsp;&nbsp;-1:&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;1:&nbsp;-50,<br>&nbsp;&nbsp;&nbsp;&nbsp;4:&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1:&nbsp;1,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1:&nbsp;6,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-2:&nbsp;h'fe49acf5b92b6e923594f2e83368f680ac924be93cf533aecaf802e37757f8c9'<br>&nbsp;&nbsp;&nbsp;&nbsp;},<br>&nbsp;&nbsp;&nbsp;&nbsp;6:&nbsp;h'3e924621deec70765b2da2d21f8d6e9dd9a2e3e32cd470d8b2be5abd9c8e5809e95e5a92b977fa3c2de37c77c9370fc492ecb9cb54e8d27d3a107d235cd7360f'<br>&nbsp;&nbsp;}<br>}</div></div>
<h5>5.2.&nbsp; Validation</h5>
By simply combining the objects retrived during the decryption phase,
the <a href='#signed-authorization'>Signed&nbsp;Authorization</a> object is recreated:
<div class='webpkifloat'><div class='webpkibox' id='signed-authz.txt' style='width:50em'>{<br>&nbsp;&nbsp;1:&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;1:&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1:&nbsp;&quot;Space&nbsp;Shop&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:&nbsp;&quot;722385402&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3:&nbsp;&quot;600.00&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4:&nbsp;&quot;EUR&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;},<br>&nbsp;&nbsp;&nbsp;&nbsp;2:&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1:&nbsp;&quot;https://banknet2.org&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:&nbsp;&quot;mybank.com&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;},<br>&nbsp;&nbsp;2:&nbsp;&quot;spaceshop.com&quot;,<br>&nbsp;&nbsp;3:&nbsp;&quot;FR7630002111110020050014382&quot;,<br>&nbsp;&nbsp;4:&nbsp;&quot;010049255&quot;,<br>&nbsp;&nbsp;5:&nbsp;[&quot;Android&quot;,&nbsp;&quot;14.1&quot;],<br>&nbsp;&nbsp;6:&nbsp;[&quot;Saturn&quot;,&nbsp;&quot;1.0.0&quot;],<br>&nbsp;&nbsp;8:&nbsp;&quot;2024-09-01T13:28:02-02:00&quot;,<br>&nbsp;&nbsp;-1:&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;1:&nbsp;-50,<br>&nbsp;&nbsp;&nbsp;&nbsp;4:&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1:&nbsp;1,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1:&nbsp;6,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-2:&nbsp;h'fe49acf5b92b6e923594f2e83368f680ac924be93cf533aecaf802e37757f8c9'<br>&nbsp;&nbsp;&nbsp;&nbsp;},<br>&nbsp;&nbsp;&nbsp;&nbsp;6:&nbsp;h'3e924621deec70765b2da2d21f8d6e9dd9a2e3e32cd470d8b2be5abd9c8e5809e95e5a92b977fa3c2de37c77c9370fc492ecb9cb54e8d27d3a107d235cd7360f'<br>&nbsp;&nbsp;}<br>}</div></div>
Since this object contains a <code>publicKey</code>
attribute, it can be validated using &quot;as&nbsp;is&quot;.
<p>
Note that the <i>trust</i> in the supplied public key <b>must</b>
be verified <i>before</i> the authorization object is used!
</p>
<h3 id='test-vectors'>6.&nbsp; Test Vectors</h3>
Equipped with an appropriate diagnostic notation parser like
<a href='https://cyberphone.github.io/CBOR.js/doc/playground.html'>
https://cyberphone.github.io/CBOR.js/doc/playground.html
</a> and COSE algorithm support, the <a href='#authz-res.txt'>sample authorization</a>
should be possible to decrypt and verify, using the following sample keys.
<div style='margin-top:0.8em'>Authorization key in JWK format:</div>
<div class='webpkifloat'><div class='webpkibox' id='authorization-key.jwk' style='width:50em'>{<br>&nbsp;&nbsp;&quot;kty&quot;:&nbsp;&quot;OKP&quot;,<br>&nbsp;&nbsp;&quot;crv&quot;:&nbsp;&quot;Ed25519&quot;,<br>&nbsp;&nbsp;&quot;x&quot;:&nbsp;&quot;_kms9bkrbpI1lPLoM2j2gKySS-k89TOuyvgC43dX-Mk&quot;,<br>&nbsp;&nbsp;&quot;d&quot;:&nbsp;&quot;0flr-6bXs459f9qwAq20Zs3NizTGIEH5_rTDFoumFV4&quot;<br>}<br></div></div>
<div style='margin-top:0.8em'>Authorization key in COSE format:</div>
<div class='webpkifloat'><div class='webpkibox' id='authorization-key.txt' style='width:50em'>{<br>&nbsp;&nbsp;1:&nbsp;1,<br>&nbsp;&nbsp;-1:&nbsp;6,<br>&nbsp;&nbsp;-2:&nbsp;h'fe49acf5b92b6e923594f2e83368f680ac924be93cf533aecaf802e37757f8c9',<br>&nbsp;&nbsp;-4:&nbsp;h'd1f96bfba6d7b38e7d7fdab002adb466cdcd8b34c62041f9feb4c3168ba6155e'<br>}</div></div>
<div style='margin-top:0.8em'>Encryption key in JWK format:</div>
<div class='webpkifloat'><div class='webpkibox' id='encryption-key.jwk' style='width:50em'>{<br>&nbsp;&nbsp;&quot;kty&quot;:&nbsp;&quot;EC&quot;,<br>&nbsp;&nbsp;&quot;crv&quot;:&nbsp;&quot;P-256&quot;,<br>&nbsp;&nbsp;&quot;x&quot;:&nbsp;&quot;6BKxpty8cI-exDzCkh-goU6dXq3MbcY0cd1LaAxiNrU&quot;,<br>&nbsp;&nbsp;&quot;y&quot;:&nbsp;&quot;mCbcvUzm44j3Lt2b5BPyQloQ91tf2D2V-gzeUxWaUdg&quot;,<br>&nbsp;&nbsp;&quot;d&quot;:&nbsp;&quot;6XxMFXhcYT5QN9w5TIg2aSKsbcj-pj4BnZkK7ZOt4B8&quot;<br>}<br></div></div>
<div style='margin-top:0.8em'>Encryption key in COSE format:</div>
<div class='webpkifloat'><div class='webpkibox' id='encryption-key.txt' style='width:50em'>{<br>&nbsp;&nbsp;1:&nbsp;2,<br>&nbsp;&nbsp;-1:&nbsp;1,<br>&nbsp;&nbsp;-2:&nbsp;h'e812b1a6dcbc708f9ec43cc2921fa0a14e9d5eadcc6dc63471dd4b680c6236b5',<br>&nbsp;&nbsp;-3:&nbsp;h'9826dcbd4ce6e388f72edd9be413f2425a10f75b5fd83d95fa0cde53159a51d8',<br>&nbsp;&nbsp;-4:&nbsp;h'e97c4c15785c613e5037dc394c88366922ac6dc8fea63e019d990aed93ade01f'<br>}</div></div>
<h3 id='version'>Version</h3>
  API version: 1.0.0<br>
  Document version: 2024-09-04
</body>
</html>