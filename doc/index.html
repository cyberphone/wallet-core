<!DOCTYPE html>
<html lang='en'>
<head>
  <link rel='icon' href='webpkiorg.png' sizes='192x192'>
  <meta name='viewport' content='initial-scale=1.0'>
  <meta charset='UTF-8'>
  <title>Wallet Core</title>
  <link rel='stylesheet' type='text/css' href='style.css'>
</head>
<body>
<h3 style="text-align:center;font-weight:normal;font-size:1.5em">Saturn - Payment Authorization Wallet</h3>
<i>Disclaimer: this is a specification in an early state, subject to change without notice.</i>
<h3 id='introduction'>1.&nbsp; Introduction</h3>
This document describes the core components of the Saturn wallet.
Note that Saturn is a <i>payment authorization </i> system for end-users,
not a payment system.  Saturn is heavily influenced by the current
&quot;gold&nbsp;standard&quot; for consumer payments, <a href='https://www.emvco.com/'>EMV<img src='xtl.svg' alt='emv'></a>.
<p style='padding-bottom:0;margin-bottom:0'>
Compared to EMV, Saturn introduces several enhancements:
</p>
<ul style='padding-top:0;margin-top:0'>
  <li style='padding-top:0.5em'>For privacy reasons user authorizations are <i>encrypted</i>.</li>
  <li>Intended to work with <i>any</i> account based payment system.</li>
  <li>Eliminates specific on-line solutions like 3D Secure.</li>
  <li>Receipt option.</li>
  <li>Account balance option.</li>
  <li>Built-in support for authorization of non-direct payments.</li>
</ul>
<p>
Saturn builds on the idea that different payment networks should not
need unique user authorizations solutions; only identifiers
related to accounts and payment networks need to be adapted.
This data is provided in the associated virtual payment cards (payment credentials),
making the wallet software <i>universal</i>.
</p>
The sequence diagram below outlines the Saturn protocol: 
<div class='webpkifloat'><img src='sequence-diagram.png' class='webpkibox' style='width:50em' title='Sequence Diagram'></div>
<h3 id='operation'>2.&nbsp; Detailed Operation</h3>
To guide the reader, operation is described based on an example which
in turn provides links to the formal definitions.
<p>
The Saturn protocol is based on CBOR [<a href='https://www.rfc-editor.org/rfc/rfc8949.html'>RFC8949<img src='xtl.svg' alt='rfc8949'></a>] which is a <i>binary</i> interchange format.
However, for documentation purposes, messages are shown in <i>diagnostic notation</i>.
</p>
<h5 id='initation'>2.1.&nbsp; Initiation</h5>
The payment proccess is initiated when the Payer hits a &quot;Pay&quot;
button on the Web or scans a QR-code, causing the wallet to perfom a HTTP&nbsp;GET
(step #1 in the sequence diagram) to the Payee service.  This returns a <a href='#authorization-request'>Authorization Request</a>
(step #2 in the sequence diagram) like the following:
<div class='webpkifloat'><div class='webpkibox' id='authz-req.txt' style='width:50em'>{<br>&nbsp;&nbsp;1:&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;1:&nbsp;&quot;Space&nbsp;Shop&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;2:&nbsp;&quot;722385402&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;3:&nbsp;&quot;600.00&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;4:&nbsp;&quot;EUR&quot;<br>&nbsp;&nbsp;},<br>&nbsp;&nbsp;2:&nbsp;[&quot;https://cardnetwork.com&quot;,&nbsp;&quot;https://banknet2.org&quot;]<br>}</div></div>
<h5 id='wallet-request-ui'>2.2.&nbsp; Wallet Request UI</h5>
After receival of the <a href='#authorization-request'>Authorization Request</a>,
the wallet should display a UI like the following:
<div class='webpkifloat'><img src='wallet-ui.svg' style='padding:0;width:25em' class='webpkibox'  title='Wallet UI'></div>
If the wallet contains multiple 
<a href='#payment-credentials'>Payment&nbsp;Credentials</a>
matching the Payee
request, the Payer needs to select (step #3 in the sequence diagram) a suitable
credential, unless the default (or last used) is deamed suitable.
<h5 id='payer-authorizes-the-request'>2.3.&nbsp; Payer Authorizes the Request</h5>
Assuming that the Payer accepts and subsequently authorizes 
(step #4 in the sequence diagram) the request,
the wallet will perform a HTTP&nbsp;POST (step #5 in the sequence diagram)
to the Payee service containing an
<a href='#authorization-response'>Authorization Response</a>
object like the following: 
<div class='webpkifloat'><div class='webpkibox' id='authz-res.txt' style='width:50em'>1010([&quot;https://saturn.standard/v4&quot;,&nbsp;{<br>&nbsp;&nbsp;0:&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;1:&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1:&nbsp;&quot;Space&nbsp;Shop&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:&nbsp;&quot;722385402&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3:&nbsp;&quot;600.00&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4:&nbsp;&quot;EUR&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;},<br>&nbsp;&nbsp;&nbsp;&nbsp;2:&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1:&nbsp;&quot;https://banknet2.org&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:&nbsp;&quot;mybank.com&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;},<br>&nbsp;&nbsp;1:&nbsp;3,<br>&nbsp;&nbsp;2:&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;1:&nbsp;-29,<br>&nbsp;&nbsp;&nbsp;&nbsp;4:&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1:&nbsp;2,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1:&nbsp;1,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-2:&nbsp;h'e812b1a6dcbc708f9ec43cc2921fa0a14e9d5eadcc6dc63471dd4b680c6236b5',<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-3:&nbsp;h'9826dcbd4ce6e388f72edd9be413f2425a10f75b5fd83d95fa0cde53159a51d8'<br>&nbsp;&nbsp;&nbsp;&nbsp;},<br>&nbsp;&nbsp;&nbsp;&nbsp;7:&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1:&nbsp;2,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1:&nbsp;1,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-2:&nbsp;h'bb0b3ae5798b88baa90bd092b8fc73342bab54dcebda521a4168a41f95975115',<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-3:&nbsp;h'd013201742a024428f948ac72a22d0330753b38cd81d89aea479a5613d9f996a'<br>&nbsp;&nbsp;&nbsp;&nbsp;},<br>&nbsp;&nbsp;&nbsp;&nbsp;10:&nbsp;h'455902a8de3a50701ae58e622a50abeacdabc728d6514803f47564a7ef3858080758f315bf79a1f5'<br>&nbsp;&nbsp;},<br>&nbsp;&nbsp;8:&nbsp;h'899ca17f3aafefe998ccff26c2320169',<br>&nbsp;&nbsp;9:&nbsp;h'8c87ab279f2a9da59a17659f',<br>&nbsp;&nbsp;10:&nbsp;h'435cf10d376d1238d3f3715fbe2dc3f334dccff020344eed0524d71965abcba240261e66d305e3e550f97f06d0c8d1c3bfc3285f4186092ad299f592579c18fa649ccaaa8afb08ca682cc2edc65f037f3b9b62f90e85fdc3313ea69f339e68e7da57bf11af46c10bccb0756ff2d78d41aa3c05148b4ae7e2eadf18413ae728758f47b8d2be33117978030898e5c112c704d7c21893248f7c12c3940a0a2373d586c76c6b355f02990c86418cc85083f158382f74f5d98c882c2426215c92a359bdb2e272597aa4cad21f5f1d95ad1815b088a294090c0d5c24dff0548ae896f274f6bf9e'<br>}])</div></div>
<h5 id='wallet-termination'>2.4.&nbsp; Wallet Termination</h5>
After successful (or failed) authorization, the 
<a href='#authorization-response'>Authorization Response</a>
should return a message (step #6 in the sequence diagram).
This message depends on how the payment process was initiated,
and is yet to be specified.
<h3 id='reference'>3.&nbsp; Reference</h3>
This section contains a reference to the components underpinning Saturn messages.
The components are based on CBOR <code>map</code> objects.
<h5 id='authorization-request'>3.1.&nbsp; Authorization Request</h5><div class='webpkifloat'><table class='webpkitable' style='width:52em'><tr><th>Label</th><th>Name</th><th>Type</th><th style='width:100%'>Description</th></tr><tr><td style='text-align:center'><code>1</code></td><td><kbd>paymentRequest</kbd></td><td style='text-align:center'><code>map</code></td><td>Holds the <a href='#payment-request'>Payment&nbsp;Request</a> object.</td></tr><tr><td style='text-align:center'><code>2</code></td><td><kbd>paymentNetworks</kbd></td><td style='text-align:center'><code>array</code></td><td>Holds a non-empty list of payment network/method identifiers that the Payee (merchant) supports.  Identifiers are expressed as CBOR strings (tstr).</td></tr></table></div>Authorization Request is the core Payee (merchant) to wallet message. In same-device Web contexts this message is also associated with opening the wallet application.
<h5 id='authorization-response'>3.2.&nbsp; Authorization Response</h5>An Authorization Response consists of a single <a href='https://cyberphone.github.io/javaapi/org/webpki/cbor/doc-files/encryption.html'>CEF<img src='xtl.svg' alt='cef'></a> object, where the outermost element is a <a href='https://www.ietf.org/archive/id/draft-rundgren-cotx-04.html'>COTX<img src='xtl.svg' alt='cotx'></a> wrapper with ID=<code>https://saturn.standard/v4</code>.  The CEF inner elements are as follows:<div class='webpkifloat'><table class='webpkitable' style='width:52em'><tr><th>Label</th><th>Name</th><th>Type</th><th style='width:100%'>Description</th></tr><tr><td style='text-align:center'><code>0</code></td><td><kbd>customData</kbd></td><td style='text-align:center'><code>map</code></td><td>CEF: custom (<i>unencrypted</i>) data in the form of a copy of the <a href='#pass-through'>&quot;Pass&nbsp;Through&quot;&nbsp;Data</a> object.</td></tr><tr><td style='text-align:center'><code>10</code></td><td><kbd>cipherText</kbd></td><td style='text-align:center'><code>bstr</code></td><td>CEF: <i>encrypted</i> <a href='#signed-authorization'>Signed&nbsp;Authorization</a> having the <a href='#pass-through'>&quot;Pass&nbsp;Through&quot;&nbsp;Data</a> object being removed <i>after</i> signing. Note that the modified <a href='#signed-authorization'>Signed&nbsp;Authorization</a> <code>map</code> object <b>must</b> be updated to refect the removal of the <a href='#pass-through'>&quot;Pass&nbsp;Through&quot;&nbsp;Data</a> object.</td></tr></table></div>
<h5 id='pass-through'>3.3.&nbsp; &quot;Pass Through&quot; Data</h5><div class='webpkifloat'><table class='webpkitable' style='width:52em'><tr><th>Label</th><th>Name</th><th>Type</th><th style='width:100%'>Description</th></tr><tr><td style='text-align:center'><code>1</code></td><td><kbd>paymentRequest</kbd></td><td style='text-align:center'><code>map</code></td><td>By including a copy of the <a href='#payment-request'>Payment&nbsp;Request</a> in the user authorization, this object remains <i>authoritative</i> throughout the payment process (except for interbank operations).</td></tr><tr><td style='text-align:center'><code>2</code></td><td><kbd>serviceProvider</kbd></td><td style='text-align:center'><code>map</code></td><td>Holds the <a href='#service-provider'>Service&nbsp;Provider&nbsp;Information</a> required by the Payee (merchant) for deriving which payment network to use and initiating a compatible payment transaction request.</td></tr></table></div>
<h5 id='payment-request'>3.4.&nbsp; Payment Request</h5><div class='webpkifloat'><table class='webpkitable' style='width:52em'><tr><th>Label</th><th>Name</th><th>Type</th><th style='width:100%'>Description</th></tr><tr><td style='text-align:center'><code>1</code></td><td><kbd>commonName</kbd></td><td style='text-align:center'><code>tstr</code></td><td>Payee (merchant) common name to be shown in UIs.</td></tr><tr><td style='text-align:center'><code>2</code></td><td><kbd>instanceId</kbd></td><td style='text-align:center'><code>tstr</code></td><td>Payee (merchant) transaction Id.</td></tr><tr><td style='text-align:center'><code>3</code></td><td><kbd>amount</kbd></td><td style='text-align:center'><code>tstr</code></td><td>Monetary amount.</td></tr><tr><td style='text-align:center'><code>4</code></td><td><kbd>currency</kbd></td><td style='text-align:center'><code>tstr</code></td><td>Currency.</td></tr><tr><td style='text-align:center'><code>5</code></td><td><kbd>nonDirect</kbd></td><td style='text-align:center'><code>map</code></td><td><i>Optional</i>: Non-direct payment request.</td></tr></table></div>
<h5 id='service-provider'>3.5.&nbsp; Service Provider Information</h5><div class='webpkifloat'><table class='webpkitable' style='width:52em'><tr><th>Label</th><th>Name</th><th>Type</th><th style='width:100%'>Description</th></tr><tr><td style='text-align:center'><code>1</code></td><td><kbd>paymentNetwork</kbd></td><td style='text-align:center'><code>tstr</code></td><td>Copy of the same attribute in the selected virtual card (see <a href='#payment-credentials'>Payment&nbsp;Credentials</a>).</td></tr><tr><td style='text-align:center'><code>2</code></td><td><kbd>paymentService</kbd></td><td style='text-align:center'><code>tstr</code></td><td>Copy of the same attribute in the selected virtual card (see <a href='#payment-credentials'>Payment&nbsp;Credentials</a>).</td></tr></table></div>
<h5 id='signed-authorization'>3.6.&nbsp; Signed Authorization</h5><div class='webpkifloat'><table class='webpkitable' style='width:52em'><tr><th>Label</th><th>Name</th><th>Type</th><th style='width:100%'>Description</th></tr><tr><td style='text-align:center'><code>1</code></td><td><kbd>passThrough</kbd></td><td style='text-align:center'><code>map</code></td><td>Holds the <a href='#pass-through'>&quot;Pass&nbsp;Through&quot;&nbsp;Data</a> object.</td></tr><tr><td style='text-align:center'><code>2</code></td><td><kbd>payeeHost</kbd></td><td style='text-align:center'><code>tstr</code></td><td>Host name or IP address of invoking Payee (merchant).</td></tr><tr><td style='text-align:center'><code>3</code></td><td><kbd>accountId</kbd></td><td style='text-align:center'><code>tstr</code></td><td>Account identifier associated with the virtual card.</td></tr><tr><td style='text-align:center'><code>4</code></td><td><kbd>serialNumber</kbd></td><td style='text-align:center'><code>tstr</code></td><td>Serial number of the virtual card.</td></tr><tr><td style='text-align:center'><code>5</code></td><td><kbd>platformData</kbd></td><td style='text-align:center'><code>array</code></td><td>Array holding the name and version of the operating system in <code>[0]</code> and <code>[1]</code> respectively, expressed as CBOR strings.</td></tr><tr><td style='text-align:center'><code>6</code></td><td><kbd>walletData</kbd></td><td style='text-align:center'><code>array</code></td><td>Array holding the name and version of the wallet software in <code>[0]</code> and <code>[1]</code> respectively, expressed as CBOR strings.</td></tr><tr><td style='text-align:center'><code>7</code></td><td><kbd>location</kbd></td><td style='text-align:center'><code>array</code></td><td><i>Optional</i>: Array holding longitude <code>[0]</code> and latitude <code>[1]</code>, expressed as CBOR floats.</td></tr><tr><td style='text-align:center'><code>8</code></td><td><kbd>timeStamp</kbd></td><td style='text-align:center'><code>tstr</code></td><td>ISO date-time string using UTC (T) or local time (Z) format.</td></tr><tr><td style='text-align:center'><code>-1</code></td><td><kbd>signature</kbd></td><td style='text-align:center'><code>map</code></td><td>Authorization signature.</td></tr></table></div>
<h3 id='payment-credentials'>4.&nbsp; Payment Credentials</h3>
A fundamental part of the wallet is a local database holding
enrolled payment credentials.
Note that although credentials herein are expressed as CBOR,
other representations may be used.
The only requirement is that credential attributes can be securely
mapped back and forth to CBOR.
<p style='margin-bottom:0.5em;padding-bottom:0'>
Each entry in the database contains a payment credential according
to the following definition:
</p>
<div class='webpkifloat'><table class='webpkitable' style='width:52em'><tr><th>Label</th><th>Name</th><th>Type</th><th style='width:100%'>Description</th></tr><tr><td style='text-align:center'><code>1</code></td><td><kbd>paymentNetwork</kbd></td><td style='text-align:center'><code>tstr</code></td><td>Payment network/method identifier. Since payment networks are likely to continue having unique message solutions, the Payee needs to identify the specific network before making a transation request. Payment network identifiers may be expressed as URLs or as simple names like "VISA".  Note that this concept does not make a distinction between payment methods or "schemes".</td></tr><tr><td style='text-align:center'><code>2</code></td><td><kbd>paymentService</kbd></td><td style='text-align:center'><code>tstr</code></td><td>Payment service URL or host name. This attribute enables the Payee to find the end-point of the specific payment service (like a bank), assocated with the payment credential. How to interprete this attribute is dictated by the <kbd>paymentNetwork</kbd> identifier. If <kbd>paymentService</kbd> is expressed as a host-name only, a <code style='white-space:nowrap'>&quot;.well-known&quot;</code> [<a href='https://www.rfc-editor.org/rfc/rfc8615'>RFC8615<img src='xtl.svg' alt='rfc8615'></a>] extension would typically be used.</td></tr></table></div>
<h3 id='authorization-processing'>5.&nbsp; Authorization Processing</h3>
This section describes how
<a href='#authorization-response'>Authorization&nbsp;Response</a> messages
should be processed, using the
<a href='#authz-res.txt'>Sample&nbsp;Object</a>  and
<a href="#test-vectors">Test Vectors</a>.
<h5>5.1.&nbsp; Decryption</h5>
Firstly the <a href='#authorization-response'>Authorization&nbsp;Response</a>
object needs to be <i>decrypted</i> using a private key associated with the 
supplied <a href='https://cyberphone.github.io/javaapi/org/webpki/cbor/doc-files/encryption.html'>CEF<img src='xtl.svg' alt='cef'></a> <kbd>publicKey</kbd> or <kbd>keyId</kbd> attribute.
In the sample, a <kbd>publicKey</kbd> attribute was used.
The decryption process should return two CBOR objects:
the <a href='#patj-through'>&quot;Path Through&quot;Information</a>
object which is supplied in clear:
<div class='webpkifloat'><div class='webpkibox' id='pass-through.txt' style='width:50em'>{<br>&nbsp;&nbsp;1:&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;1:&nbsp;&quot;Space&nbsp;Shop&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;2:&nbsp;&quot;722385402&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;3:&nbsp;&quot;600.00&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;4:&nbsp;&quot;EUR&quot;<br>&nbsp;&nbsp;},<br>&nbsp;&nbsp;2:&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;1:&nbsp;&quot;https://banknet2.org&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;2:&nbsp;&quot;mybank.com&quot;<br>&nbsp;&nbsp;}<br>}</div></div>
and another object which after decryption should read like the following:
<div class='webpkifloat'><div class='webpkibox' id='restored.txt' style='width:50em'>{<br>&nbsp;&nbsp;2:&nbsp;&quot;spaceshop.com&quot;,<br>&nbsp;&nbsp;3:&nbsp;&quot;FR7630002111110020050014382&quot;,<br>&nbsp;&nbsp;4:&nbsp;&quot;010049255&quot;,<br>&nbsp;&nbsp;5:&nbsp;[&quot;Android&quot;,&nbsp;&quot;14.1&quot;],<br>&nbsp;&nbsp;6:&nbsp;[&quot;Saturn&quot;,&nbsp;&quot;1.0.0&quot;],<br>&nbsp;&nbsp;8:&nbsp;&quot;2024-09-01T13:28:02-02:00&quot;,<br>&nbsp;&nbsp;-1:&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;1:&nbsp;-50,<br>&nbsp;&nbsp;&nbsp;&nbsp;4:&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1:&nbsp;1,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1:&nbsp;6,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-2:&nbsp;h'fe49acf5b92b6e923594f2e83368f680ac924be93cf533aecaf802e37757f8c9'<br>&nbsp;&nbsp;&nbsp;&nbsp;},<br>&nbsp;&nbsp;&nbsp;&nbsp;6:&nbsp;h'3e924621deec70765b2da2d21f8d6e9dd9a2e3e32cd470d8b2be5abd9c8e5809e95e5a92b977fa3c2de37c77c9370fc492ecb9cb54e8d27d3a107d235cd7360f'<br>&nbsp;&nbsp;}<br>}</div></div>
<h5>5.2.&nbsp; Validation</h5>
By simply combining the objects retrived during the decryption phase,
the <a href='#signed-authorization'>Signed&nbsp;Authorization</a> object is recreated:
<div class='webpkifloat'><div class='webpkibox' id='signed-authz.txt' style='width:50em'>{<br>&nbsp;&nbsp;1:&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;1:&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1:&nbsp;&quot;Space&nbsp;Shop&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:&nbsp;&quot;722385402&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3:&nbsp;&quot;600.00&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4:&nbsp;&quot;EUR&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;},<br>&nbsp;&nbsp;&nbsp;&nbsp;2:&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1:&nbsp;&quot;https://banknet2.org&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:&nbsp;&quot;mybank.com&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;},<br>&nbsp;&nbsp;2:&nbsp;&quot;spaceshop.com&quot;,<br>&nbsp;&nbsp;3:&nbsp;&quot;FR7630002111110020050014382&quot;,<br>&nbsp;&nbsp;4:&nbsp;&quot;010049255&quot;,<br>&nbsp;&nbsp;5:&nbsp;[&quot;Android&quot;,&nbsp;&quot;14.1&quot;],<br>&nbsp;&nbsp;6:&nbsp;[&quot;Saturn&quot;,&nbsp;&quot;1.0.0&quot;],<br>&nbsp;&nbsp;8:&nbsp;&quot;2024-09-01T13:28:02-02:00&quot;,<br>&nbsp;&nbsp;-1:&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;1:&nbsp;-50,<br>&nbsp;&nbsp;&nbsp;&nbsp;4:&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1:&nbsp;1,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1:&nbsp;6,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-2:&nbsp;h'fe49acf5b92b6e923594f2e83368f680ac924be93cf533aecaf802e37757f8c9'<br>&nbsp;&nbsp;&nbsp;&nbsp;},<br>&nbsp;&nbsp;&nbsp;&nbsp;6:&nbsp;h'3e924621deec70765b2da2d21f8d6e9dd9a2e3e32cd470d8b2be5abd9c8e5809e95e5a92b977fa3c2de37c77c9370fc492ecb9cb54e8d27d3a107d235cd7360f'<br>&nbsp;&nbsp;}<br>}</div></div>
Since this object contains a <a href='https://cyberphone.github.io/javaapi/org/webpki/cbor/doc-files/signatures.html'>CSF<img src='xtl.svg' alt='csf'></a> <kbd>publicKey</kbd>
attribute, it can be validated using &quot;as&nbsp;is&quot;.
<p>
Note that the <i>trust</i> in a received public key <b>must</b>
be verified <i>before</i> the authorization object is used!
</p>
<h3 id='test-vectors'>6.&nbsp; Test Vectors</h3>
Equipped with an appropriate diagnostic notation parser like
<a href='https://cyberphone.github.io/CBOR.js/doc/playground.html'>
https://cyberphone.github.io/CBOR.js/doc/playground.html
</a> and <a href='https://cyberphone.github.io/javaapi/org/webpki/cbor/doc-files/encryption.html'>CEF<img src='xtl.svg' alt='cef'></a>/<a href='https://cyberphone.github.io/javaapi/org/webpki/cbor/doc-files/signatures.html'>CSF<img src='xtl.svg' alt='csf'></a> support, the <a href='#authz-res.txt'>Sample Authorization</a>
should be possible to decrypt and verify, using the following sample keys.
<div style='margin-top:0.8em'>Authorization key in JWK format:</div>
<div class='webpkifloat'><div class='webpkibox' id='authorization-key.jwk' style='width:50em'>{<br>&nbsp;&nbsp;&quot;kty&quot;:&nbsp;&quot;OKP&quot;,<br>&nbsp;&nbsp;&quot;crv&quot;:&nbsp;&quot;Ed25519&quot;,<br>&nbsp;&nbsp;&quot;x&quot;:&nbsp;&quot;_kms9bkrbpI1lPLoM2j2gKySS-k89TOuyvgC43dX-Mk&quot;,<br>&nbsp;&nbsp;&quot;d&quot;:&nbsp;&quot;0flr-6bXs459f9qwAq20Zs3NizTGIEH5_rTDFoumFV4&quot;<br>}<br></div></div>
<div style='margin-top:0.8em'>Authorization key in COSE format:</div>
<div class='webpkifloat'><div class='webpkibox' id='authorization-key.txt' style='width:50em'>{<br>&nbsp;&nbsp;1:&nbsp;1,<br>&nbsp;&nbsp;-1:&nbsp;6,<br>&nbsp;&nbsp;-2:&nbsp;h'fe49acf5b92b6e923594f2e83368f680ac924be93cf533aecaf802e37757f8c9',<br>&nbsp;&nbsp;-4:&nbsp;h'd1f96bfba6d7b38e7d7fdab002adb466cdcd8b34c62041f9feb4c3168ba6155e'<br>}</div></div>
<div style='margin-top:0.8em'>Encryption key in JWK format:</div>
<div class='webpkifloat'><div class='webpkibox' id='encryption-key.jwk' style='width:50em'>{<br>&nbsp;&nbsp;&quot;kty&quot;:&nbsp;&quot;EC&quot;,<br>&nbsp;&nbsp;&quot;crv&quot;:&nbsp;&quot;P-256&quot;,<br>&nbsp;&nbsp;&quot;x&quot;:&nbsp;&quot;6BKxpty8cI-exDzCkh-goU6dXq3MbcY0cd1LaAxiNrU&quot;,<br>&nbsp;&nbsp;&quot;y&quot;:&nbsp;&quot;mCbcvUzm44j3Lt2b5BPyQloQ91tf2D2V-gzeUxWaUdg&quot;,<br>&nbsp;&nbsp;&quot;d&quot;:&nbsp;&quot;6XxMFXhcYT5QN9w5TIg2aSKsbcj-pj4BnZkK7ZOt4B8&quot;<br>}<br></div></div>
<div style='margin-top:0.8em'>Encryption key in COSE format:</div>
<div class='webpkifloat'><div class='webpkibox' id='encryption-key.txt' style='width:50em'>{<br>&nbsp;&nbsp;1:&nbsp;2,<br>&nbsp;&nbsp;-1:&nbsp;1,<br>&nbsp;&nbsp;-2:&nbsp;h'e812b1a6dcbc708f9ec43cc2921fa0a14e9d5eadcc6dc63471dd4b680c6236b5',<br>&nbsp;&nbsp;-3:&nbsp;h'9826dcbd4ce6e388f72edd9be413f2425a10f75b5fd83d95fa0cde53159a51d8',<br>&nbsp;&nbsp;-4:&nbsp;h'e97c4c15785c613e5037dc394c88366922ac6dc8fea63e019d990aed93ade01f'<br>}</div></div>
<h3 id='version'>Version</h3>
  API version: 1.0.0<br>
  Document version: 2024-09-04
</body>
</html>